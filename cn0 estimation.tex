\documentclass{article}
\usepackage[T2A]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage[english,russian]{babel}
\usepackage{amssymb,amsfonts,amsmath,mathtext,cite,enumerate,float}

\usepackage{geometry} % Меняем поля страницы
\geometry{left=1.5cm}% левое поле
\geometry{right=1.5cm}% правое поле
\geometry{top=2cm}% верхнее поле
\geometry{bottom=2cm}% нижнее поле
\usepackage[final]{graphicx}
\usepackage{filecontents}
\usepackage{tikz}
\usetikzlibrary{shapes,arrows}

\tikzstyle{point} = [coordinate]

\tikzstyle{dot} = [draw, fill=black , circle, ,inner sep=1pt]
\tikzstyle{block} = [draw, rectangle, 
    minimum height=1cm, minimum width=1cm]
    
\tikzstyle{sensor}=[draw, text width=5em, 
    text centered, baseline=0]    

\begin{document}

\section*{Оценка отношения мощности сигнала к спектральной плотности мощности шума}

Оценка $CN_{0}$ сигнала в слежении является необходимым атрибутом современного спутникового навигационного приёмника. Она не только характеризует условия приёма, но и является главным показателем состояния и эффективности системы слежения.  На основании этой статистики можно сделать выводы об электромагнитной обстановке(благоприятной или нет), о шумах в каналах слежения, о качестве входного тракта приемника(при наличии измерительного оборудования, способного формировать сигнал заданной мощности). Знание оценки $CN_{0}$ позволяет оценивать параметры шумов в системе слежения и дает возможность построения оптимальных сглаживающих фильтров, а также выбора оптимального времени накопления(когерентного и некогерентного).

В спутниковых навигационных системах $CN_{0}$ (carier to noise density ratio) представляет собой отношение мощности несущей принятого сигнала $C$ к спектральной плотности мощности шума $N_{0}$.

\paragraph{Алгоритм оценки. \\}

Сигнал на выходе коррелятора может быть представлен в виде
\begin{equation} \label{y}
\dot{y}_{k} = \sqrt{S}a_{k}e^{j\varphi_{0}} + \sqrt{N}\dot{n}_{k},
\end{equation}
где $S$ и $N$ --- неизвестные значения мощности сигнала и шума соответственно, $a_{k} = \pm 1$	в зависимости от знака бита, $\varphi_{0}$ --- случайная начальная фаза. Гауссовский шум $\dot{n}_{k}$ имеет нулевое математическое ожидание и корреляционную функцию $K_{ij}=\left<\dot{n}_{i}\dot{n}_{j}^{*}\right> = \delta_{ij}$. Шаг дискретизации соответствует времени интегрирования в корреляторе и равен $T_{int}$. 

Для формирования оценки $CN_{0}$ необходимо вычислить мощности сигнала на выходе коррелятора на одном бите в узкой полосе (когерентно)
\begin{equation} \label{pb}
P_{b} = \left|\sum_{i=0}^{M-1}\dot{y}_{i}\right|^{2}
\end{equation} 
и в широкой полосе (некогерентно)
\begin{equation} \label{ps}
P_{s} = \sum_{i=0}^{M-1}\left|\dot{y}_{i}\right|^{2},
\end{equation}
где $M$ --- количество отсчётов, приходящихся на один бит.

Используя (\ref{pb}) и (\ref{ps}) можно получить оценку мощности шума
\begin{equation} \label{N}
\widetilde{N} = \frac{MP_{s}-P_{b}}{M(M-1)}
\end{equation}
и оценку мощности сигнала
\begin{equation} \label{S}
\widetilde{S} = \frac{P_{b}-P_{s}}{M(M-1)} = \frac{P_{b}-M\widetilde{N}}{M^{2}}.
\end{equation}

Используя (\ref{y}), можно найти условные характеристики оценок мощности сигнала (\ref{S}) и мощности шума (\ref{N}). Нетрудно показать, что оценки несмещенные
\begin{gather}
b(\widetilde{S}|S, N) = \left<\widetilde{S}-S\right> = 0, \\
b(\widetilde{N}|S, N) = \left<\widetilde{N}-N\right> = 0,
\end{gather}
их дисперсии имеют вид
\begin{gather}
D(\widetilde{S}|S, N) = \frac{2SN}{M} + \frac{N^{2}}{M(M-1)}, \\
D(\widetilde{N}|S, N) = \frac{N^{2}}{M-1}.
\end{gather}

Оценка $CN_{0}$ определяется как
\begin{equation} \label{cn0_est}
\widetilde{CN_{0}} = \frac{\widetilde{S}}{\widetilde{N}}B_{eq},
\end{equation}
где $B_{eq} = 1/T_{int}$.

\paragraph{Модификации алгоритма. \\}
1) Некогерентное накопление. Прямое применение алгоритма оценки $CN_{0}$ не всегда приводит к оценке, обладающей требуемыми дисперсией и смещением. Для увеличения точности оценки необходимо дополнительное некогерентное накопление мощностей шума и сигнала и применение сглаживающих фильтров. Однако это будет приводить к увеличению времени отклика на изменение $CN_{0}$.

Некогерентное накопление заключается в суммировании мощностей в узкой и широкой полосе на нескольких битах. Если некогерентное накопление происходит на $L$ битах, мощности в узкой полосе $P_{bn}$ и широкой полосе $P_{sn}$ будут иметь вид
\begin{gather}
P_{bn} = \sum_{j=0}^{L-1}P_{bj}, \\
P_{sn} = \sum_{j=0}^{L-1}P_{sj} = \sum_{j=0}^{L-1} \sum_{i=0}^{M-1}\left|\dot{y}_{i+jM}\right|^{2}.
\end{gather}

Оценка $CN_{0}$ вычисляется по формулам (\ref{cn0_est}), (\ref{S}) и (\ref{N}), где $P_{b}$ и $P_{s}$ заменяются на $P_{bn}$ и $P_{sn}$ соответственно. Применение некогерентного накопления позволяет уменьшить дисперсию оценок мощностей сигнала и шума в $L$ раз
\begin{gather}
D_{n}(\widetilde{S}|S, N) = \frac{2SN}{LM} + \frac{N^{2}}{LM(M-1)}, \label{D_noncoh}\\
D_{n}(\widetilde{N}|S, N) = \frac{N^{2}}{L(M-1)}.
\end{gather}

Однако, естественно, это приводит к увеличению времени обновления оценки.

%Количество бит, на которых происходит некогерентное накопление зависит от предыдущей оценки $CN_{0}$.

2) Сглаживание оценок мощности сигнала и мощности шума. Ещё один способ уменьшения дисперсий оценок мощности сигнала и мощности шума --- применение сглаживающих фильтров. Оценка мощности сигнала или шума, полученная по некогерентным накоплениям, поступает на вход соответствующего сглаживающего фильтра. При этом возможно использовать разные фильтры для сигнала и для шума. Отфильтрованные значения мощностей сигнала и шума используются для вычисления оценки $CN_{0}$ по формуле (\ref{cn0_est}). Время некогерентного накопления и полоса фильтра должны определяться текущем уровнем $CN_{0}$. При низком уровне $CN_{0}$ требуется дольше по времени осуществлять некогерентное накопление и выбирать сглаживающий фильтр с узкой полосой.

%При оценки мощности шума производится усреднение мощности шума в течении 3 секунд и последующее экспоненциальное сглаживание с коэффициентом сглаживания $\alpha = 0.25$.
%
%Для сглаживания оценки мощности сигнала применяется скользящее среднее. Количество отсчётов, использующихся для расчёта скользящего среднего, зависит от зависит от предыдущей оценки $CN_{0}$.

3) Исключения влияния некодокогерентного накопления в аппаратных каналах. В виду специфики работы аппаратных каналов, первый или последний отсчёт в бите может быть накоплен неправильно. Чтобы избежать влияния некодокогерентного накопления на оценку $CN_{0}$, первый и последний отсчёт заменяются вторым и предпоследним соответственно. Такая замена вносит корреляцию между отсчётами, поэтому вместо (\ref{N}) и (\ref{S}) для вычисления мощности сигнала и мощности шума необходимо применять формулы
\begin{equation}
\widetilde{N} = \frac{MP_{s}-P_{b}}{M(M-1)-4},
\end{equation}
\begin{equation}
\widetilde{S} = \frac{P_{b}-(M+4)\widetilde{N}}{M^{2}}
\end{equation}
и использовать их при вычислении оценки $CN_{0}$ (\ref{cn0_est}).

4) Когерентное накопление на нескольких битах. При наличии информации о знаке текущего бита возможно когерентно накопить мощность на интервале большем, чем один бит. В этом случае мощность в узкой и широкой полосе вычисляется по формулам
\begin{equation}
P_{bc} = \left|\sum_{j=0}^{L-1}\sum_{i=0}^{M-1}\dot{y}_{i+jM}\right|^{2},
\end{equation}
\begin{equation}
P_{sc} = \sum_{j=0}^{L-1}P_{sj} = \sum_{j=0}^{L-1} \sum_{i=0}^{M-1}\left|\dot{y}_{i+jM}\right|^{2},
\end{equation}
где $L$ --- количество бит в когерентном накоплении.

При таком способе накопления дисперсия оценок мощностей сигнала и шума будет иметь вид
\begin{gather}
D_{c}(\widetilde{S}|S, N) = \frac{2SN}{LM} + \frac{N^{2}}{LM(LM-1)}, \label{D_coh}\\
D_{c}(\widetilde{N}|S, N) = \frac{N^{2}}{LM-1}.
\end{gather}

Сравнивая (\ref{D_noncoh}) и (\ref{D_coh}), можно прийти к следующему выводу. При больших $CN_{0}$ $S \gg N$ и вторым слагаемым в (\ref{D_noncoh}) и (\ref{D_coh}) можно пренебречь. В этом случае когерентное и некогерентное накопления на одинаковом количестве битов дают оценки мощности сигнала с равной дисперсией. Таким образом, при высоком $CN_{0}$ использование когерентного накопления не приводит к улучшению оценки. При низких $CN_{0}$ $S \ll N$ и пренебречь можно первым слагаемым в (\ref{D_noncoh}) и (\ref{D_coh}). В этом случае когерентное накопление позволяет получит оценку мощности сигнала c дисперсией в примерно $L$ раз меньше, чем дисперсия оценки при использовании некогерентного накопления.  

\paragraph{Оптимизация. \\}

До проведения оптимизации стоял вопрос об оптимальности выбора времени некогерентного накопления и полосы сглаживающего фильтра и определения правил переключения настроек в зависимости от изменения $CN_{0}$.
Таким образом, возник вопрос о проведении моделирования оценки $CN_{0}$ в различных условиях(постоянный уровень, резкие скачки, плавное изменение), на основании которого будут определены оптимальные настройки блока оценивания $CN_{0}$.

Для решения этой задачи было проведено статистическое моделирование оценки $CN_{0}$ по рассмотренному алгоритму при различных уровнях $CN_{0}$ и с разным характером изменения $CN_{0}$. По итогам моделирования были сформированы диапазоны значений $CN_{0}$, для которых подобраны оптимальные параметры оценки(время накопления и полоса сглаживающего фильтра), а также сформированы условия, при которых происходит смена параметров оценки. Были добавлены детектирование и обработка скачка $CN_{0}$ (случай, когда $CN_{0}$ изменяется более чем на $7~dBHz$. Была добавлена описанная выше модификация, исключающая влияние некодокогерентного накопления в аппаратных каналах. Был сделан вывод, что использование когерентного накопления более чем на одном бите неоправданно, поскольку оно может улучшить оценку только на том уровне $CN_{0}$, на котором уже невозможно точно определить знак бита. Блок-схема алгоритма оценки $CN_{0}$ приведена на рис. \ref{scheme}.

\begin{figure}[htb]
    \centering
    \resizebox{1\textwidth}{!}{\input{test.tikz}\unskip}
    \caption{Блок-схема алгоритма оценки} \label{scheme}
\end{figure}

\end{document}